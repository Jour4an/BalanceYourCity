<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Balance Your City</title>
<style>
  body { font-family: 'Montserrat', sans-serif; background: #f4f4f4; margin: 0; padding: 0; color: #001F3D; }
  .section { background: #fff; border-radius: 16px; padding: 20px; margin: 20px auto; max-width: 1000px; box-shadow: 0 8px 20px rgba(0,0,0,0.4); padding-bottom: 360px; }

  h1 { color: #001F3D; font-size: 2em; font-weight: 900; margin-bottom: 10px; text-align: center; }
  .intro-text { font-size: 1em; color: #333; margin-bottom: 20px; line-height: 1.4; text-align: center; }

  .progress-bar { display: flex; justify-content: space-between; margin-bottom: 20px; flex-wrap: wrap; }
  .year { flex: 1; text-align: center; padding: 10px; border-radius: 8px; background: #ddd; margin: 5px; font-weight: bold; color: #000; cursor: pointer; }
  .year.active, .year.completed { background: linear-gradient(to bottom, #FF9936, #FF4713); color: #fff; }

  .floating-controls {
    position: fixed; bottom: 0; left: 0; width: 100%;
    background: #fff; padding: 10px; box-shadow: 0 -4px 12px rgba(0,0,0,0.15);
    display: flex; flex-wrap: wrap; justify-content: center; gap: 8px; z-index: 100;
  }
  .status { border-radius: 8px; font-weight: 700; color: #fff; text-align: center; padding: 10px; font-size: 1em; flex: 1 1 100%; }
  #guidanceText { color:#333;font-weight:bold;text-align:center;font-size:0.9em;flex:1 1 100%; }

  .button { background: linear-gradient(to bottom, #FF9936, #FF4713); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 0.85em; padding: 8px 10px; flex: 1; min-width: 100px; }
  .reserve-section .button, #reserveBtn { background: linear-gradient(to bottom, #64b5f6, #0071BF); }

  input[type="range"] { width: 100%; appearance: none; height: 10px; border-radius: 5px; background: var(--track-color, #ccc); outline: none; }
  input[type="range"]::-webkit-slider-thumb { appearance: none; width: 28px; height: 28px; border-radius: 50%; background: #0071BF; border: 3px solid #fff; cursor: pointer; margin-top: -10px; }

  .slider-card { background: #f9f9f9; border-radius: 12px; padding: 30px; margin-bottom: 30px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); display: flex; align-items: center; gap: 20px; flex-wrap: wrap; }
  .slider-circle { width: 60px; height: 60px; border-radius: 50%; display: flex; justify-content: center; align-items: center; font-weight: 800; color: #fff; font-size: 1em; background: linear-gradient(to bottom, #888, #666); border: 3px solid #fff; flex-shrink: 0; }
  .slider-content { flex: 1; min-width: 200px; }
  .slider-content label { display: block; margin-bottom: 12px; font-weight: 700; }

  .projects { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 12px; margin: 20px 0; }
  .project-btn { background: linear-gradient(to bottom, #0071BF, #001F3D); color: #fff; border: 5px solid #fff; padding: 15px; height: 130px; border-radius: 12px; cursor: pointer; font-weight: 700; font-size: 0.9em; text-align: center; box-shadow: 0 4px 8px rgba(0,0,0,0.1); transition: transform 0.2s ease; display: flex; flex-direction: column; justify-content: center; align-items: center; }
  .project-btn:hover { transform: scale(1.05); }
  .project-btn.selected { background: linear-gradient(to bottom, #28a745, #1b5e20); color: #fff; border-color: #fff; }
  .project-btn.completed { background: #ccc; color: #666; opacity: 0.6; cursor: not-allowed; }
  .project-btn.critical { border: 5px solid #FF9936; }
  .project-name { font-size: 0.9em; font-weight: 800; margin-bottom: 4px; }
  .project-cost { font-size: 0.8em; margin-bottom: 6px; }
  .required-text { color: #FF9936; font-size: 0.75em; margin-top: 4px; }

  @media (max-width: 600px) {
    .floating-controls { flex-direction: column; align-items: stretch; padding: 10px; }
    .button { width: 100%; }
    .status, #guidanceText { width: 100%; }
    .section { padding-bottom: 380px; }
  }
</style>
</head>
<body>
<div class="section">
  <h1>Balance Your City</h1>
  <p class="intro-text">Welcome to the Brooks Budget Simulator! Adjust taxes, select capital projects, and manage department budgets to balance the city’s finances while meeting community needs.</p>

  <div class="progress-bar" id="yearBar"></div>

  <div class="slider-card">
    <div class="slider-circle" id="taxCircle">3%</div>
    <div class="slider-content">
      <label><strong>Tax Increase</strong></label>
      <p style="font-size:0.9em;color:#555;margin-bottom:10px;">Inflation means costs rise yearly. A 3% tax increase keeps services stable.</p>
      <input type="range" id="taxRate" min="0" max="25" value="3">
    </div>
  </div>

  <h3>Select Capital Projects</h3>
  <p style="margin-bottom:10px;font-size:0.95em;color:#333;">Select a capital project you would like for your community. Some critical infrastructure is required by certain years to maintain essential services.</p>
  <div class="projects" id="projectButtons"></div>
  <p style="margin-top:10px;font-size:0.85em;color:#555;">Disclaimer: These are popular capital projects community members said they wanted in the 2026 Brooks Budget Survey.</p>

  <h3>Adjust Department Budgets</h3>
  <div id="departmentSliders"></div>
</div>

<div class="floating-controls">
  <strong id="statusDisplay" class="status">Shortfall: $0</strong>
  <p id="guidanceText"></p>
  <button class="button" id="reserveBtn" style="display:none;">Add Surplus to Reserve</button>
  <button class="button" disabled>Reserve Fund: $<span id="reserveDisplay">0</span></button>
  <button class="button" id="useReserveBtn">Use Reserve Fund</button>
  <button class="button" id="resetBtn">Reset Year</button>
  <button class="button" id="nextYearBtn" style="display:none;">Next Year</button>
</div>

<script>
const yearBar=document.getElementById('yearBar'),taxRateInput=document.getElementById('taxRate'),taxCircle=document.getElementById('taxCircle'),projectButtonsContainer=document.getElementById('projectButtons'),departmentSlidersContainer=document.getElementById('departmentSliders'),statusDisplay=document.getElementById('statusDisplay'),reserveDisplay=document.getElementById('reserveDisplay'),reserveBtn=document.getElementById('reserveBtn'),useReserveBtn=document.getElementById('useReserveBtn'),nextYearBtn=document.getElementById('nextYearBtn'),guidanceText=document.getElementById('guidanceText');let currentYear=1,selectedProjects=[],completedProjects=[],reserve=0,surplus=0,shortfall=0;const operatingCost=31500000,projects=[{name:"Recreation Center",cost:2000000},{name:"Road Improvements",cost:3500000},{name:"Water Treatment Upgrade",cost:4000000,deadline:4,critical:true},{name:"Library Renovation",cost:1500000},{name:"Fire Station Upgrade",cost:2500000},{name:"Community Water Park",cost:1750000},{name:"Sports Complex",cost:3000000},{name:"Public Transit",cost:2250000},{name:"Bike Path Network",cost:1250000},{name:"City Hall Renovation",cost:3500000},{name:"Municipally Owned Shopping Mall",cost:2750000},{name:"New Fire Truck",cost:1000000,deadline:2,critical:true}];const departments=["RCMP/Policing Services","Snow & Ice Removal","Road & Pavement Maintenance","Parks & Playgrounds","Recreation Facilities & Programs","Community Development","Storm Water Maintenance","Municipal Public Safety","Athletic Fields"];function formatCurrency(e){return`$${Number(e).toLocaleString()}`}function renderYearBar(){yearBar.innerHTML="";for(let i=1;i<=4;i++){const y=document.createElement("div");y.className="year";y.textContent=`Year ${i}`;if(i===currentYear)y.classList.add("active");else if(i<currentYear)y.classList.add("completed");y.onclick=()=>{if(i<currentYear){currentYear=i;updateProgressBar();createProjectButtons();updateStatus()}};yearBar.appendChild(y)}}function updateProgressBar(){document.querySelectorAll(".year").forEach((e,t)=>{e.classList.remove("active","completed");if(t+1===currentYear)e.classList.add("active");else if(t+1<currentYear)e.classList.add("completed")})}function updateTaxSliderColor(){const e=parseInt(taxRateInput.value);let trackColor=e<=3?"#ccc":e>=4?"#b30000":"#ccc";taxRateInput.style.setProperty("--track-color",trackColor);taxCircle.textContent=`${e}%`;taxCircle.style.background=e>3?"linear-gradient(to bottom,#b30000,#800000)":"linear-gradient(to bottom,#0071BF,#001F3D)"}function createProjectButtons(){projectButtonsContainer.innerHTML="";projects.forEach((e,t)=>{const n=document.createElement("button");n.className="project-btn";let content=`<div class="project-name">${e.name}</div><div class="project-cost">${formatCurrency(e.cost)}</div>`;if(e.critical){content+=`<div class="required-text">Required by Year ${e.deadline}</div>`;n.classList.add("critical")}n.innerHTML=content;if(completedProjects.includes(t)){n.classList.add("completed");n.disabled=true}else{n.onclick=()=>{n.classList.toggle("selected");n.classList.contains("selected")?selectedProjects.push(t):selectedProjects=selectedProjects.filter(i=>i!==t);updateStatus()}}projectButtonsContainer.appendChild(n)})}function createDepartmentSliders(){departmentSlidersContainer.innerHTML="";departments.forEach(e=>{const id=e.replace(/\s|&/g,""),card=document.createElement("div");card.className="slider-card";card.innerHTML=`<div class="slider-circle" id="circle-${id}">100%</div><div class="slider-content"><label><strong>${e}</strong></label><input type="range" min="50" max="150" value="100" step="10" id="${id}"><div id="impact-${id}" style="font-size:0.9em;color:#555;">No change to service levels.</div></div>`;departmentSlidersContainer.appendChild(card);document.getElementById(id).addEventListener("input",()=>{const val=parseInt(document.getElementById(id).value);document.getElementById(`circle-${id}`).textContent=`${val}%`;const impact=document.getElementById(`impact-${id}`),slider=document.getElementById(id);let color=val<100?"linear-gradient(to bottom,#b30000,#800000)":val>100?"linear-gradient(to bottom,#28a745,#1b5e20)":"linear-gradient(to bottom,#888,#666)";document.getElementById(`circle-${id}`).style.background=color;slider.style.setProperty("--track-color",val<100?"#b30000":val>100?"#28a745":"#ccc");impact.textContent=val<100?"Reduced service quality.":val>100?"Improved service quality.":"No change to service levels.";updateStatus()})})}function updateStatus(){updateTaxSliderColor();const tax=parseFloat(taxRateInput.value);const revenue=3e7+500000*tax;let projectCost=selectedProjects.reduce((sum,i)=>sum+projects[i].cost,0);shortfall=operatingCost+projectCost-revenue;let deptAdj=0;departments.forEach(e=>{const val=parseInt(document.getElementById(e.replace(/\s|&/g,"")).value);deptAdj+=val<100?-250000*((100-val)/10):val>100?250000*((val-100)/10):0});shortfall+=deptAdj;surplus=shortfall<0?Math.abs(shortfall):0;shortfall=shortfall<0?0:shortfall;statusDisplay.textContent=shortfall>0?`Shortfall: ${formatCurrency(shortfall)}`:`Surplus: ${formatCurrency(surplus)}`;statusDisplay.style.background=shortfall>0?"linear-gradient(to bottom,#b30000,#800000)":"linear-gradient(to bottom,#28a745,#1b5e20)";guidanceText.textContent=shortfall>0?"You must cover the shortfall by lowering a department’s service levels or increasing taxes.":surplus>0?"You can add surplus dollars to reserve to cover capital budgets in future years.":"";reserveDisplay.textContent=reserve.toLocaleString();reserveBtn.style.display=surplus>0?"inline-block":"none";nextYearBtn.style.display=shortfall===0?"inline-block":"none"}reserveBtn.addEventListener("click",()=>{reserve+=surplus;surplus=0;statusDisplay.textContent="Surplus: $0";reserveDisplay.textContent=reserve.toLocaleString();reserveBtn.style.display="none"});useReserveBtn.addEventListener("click",()=>{if(reserve>0){if(shortfall>0){if(reserve>=shortfall){reserve-=shortfall;surplus=reserve;shortfall=0}else{shortfall-=reserve;reserve=0}}else{surplus+=reserve;reserve=0}statusDisplay.textContent=shortfall>0?`Shortfall: ${formatCurrency(shortfall)}`:`Surplus: ${formatCurrency(surplus)}`;statusDisplay.style.background=shortfall>0?"linear-gradient(to bottom,#b30000,#800000)":"linear-gradient(to bottom,#28a745,#1b5e20)";reserveDisplay.textContent=reserve.toLocaleString()}});nextYearBtn.addEventListener("click",()=>{const fireTruck=projects.findIndex(p=>p.name==="New Fire Truck"),waterUpgrade=projects.findIndex(p=>p.name==="Water Treatment Upgrade");if(currentYear===2&&!completedProjects.includes(fireTruck)&&!selectedProjects.includes(fireTruck)){alert("⚠️ You cannot proceed! New Fire Truck must be completed by Year 2.");return}if(currentYear===3&&!completedProjects.includes(waterUpgrade)&&!selectedProjects.includes(waterUpgrade)){alert("⚠️ You cannot proceed! Water Treatment Upgrade must be completed by Year 4.");return}selectedProjects.forEach(i=>{completedProjects.push(i)});selectedProjects=[];currentYear++;taxRateInput.value=3;if(currentYear>4){alert("✅ Term complete!");nextYearBtn.style.display="none"}else{renderYearBar();updateStatus();createProjectButtons()}});resetBtn.addEventListener("click",()=>{taxRateInput.value=3;selectedProjects=[];completedProjects=[];currentYear=1;renderYearBar();createProjectButtons();createDepartmentSliders();updateStatus()});taxRateInput.addEventListener("input",updateStatus);renderYearBar();createProjectButtons();createDepartmentSliders();updateStatus();
</script>
</body>
</html>