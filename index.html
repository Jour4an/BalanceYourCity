<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Balance Your City</title>
<style>
  body { font-family: 'Montserrat', sans-serif; background: #f4f4f4; margin: 0; padding: 0; color: #001F3D; }
  header { background-color: #002a4d; padding: 20px; text-align: center; color: #FF9936; font-size: 2em; font-weight: 900; }
  .section { background: #fff; border-radius: 16px; padding: 30px; margin: 20px auto; max-width: 1000px; box-shadow: 0 8px 20px rgba(0,0,0,0.4); }

  /* Progress Bar */
  .progress-bar { display: flex; justify-content: space-between; margin-bottom: 20px; }
  .year {
    flex: 1; text-align: center; padding: 10px; border-radius: 8px;
    background: linear-gradient(to bottom, #FF9936, #FF4713);
    margin: 0 5px; font-weight: bold; color: #fff;
  }

  /* Status Button */
  .status {
    display: inline-block; padding: 14px 24px; margin: 16px 0;
    border-radius: 8px; font-weight: 700; font-size: 1.3em; color: #fff;
    background: linear-gradient(to bottom, #FF9936, #FF4713);
  }

  /* Section Titles */
  h3 {
    font-size: 1.5em; font-weight: 800; color: #001F3D;
    border-bottom: 4px solid #FF9936; display: inline-block;
    margin-bottom: 15px; padding-bottom: 5px;
  }

  /* Slider Base */
  input[type="range"] {
    width: 100%; appearance: none; height: 10px; border-radius: 5px;
    background: var(--track-color, #fff); outline: none; transition: background 0.3s ease;
  }
  input[type="range"]::-webkit-slider-thumb {
    appearance: none; width: 28px; height: 28px; border-radius: 50%;
    background: #0071BF; border: 3px solid #0071BF; cursor: pointer;
    margin-top: -10px; box-shadow: 0 2px 6px rgba(0,0,0,0.3);
  }
  input[type="range"]::-moz-range-thumb {
    width: 28px; height: 28px; border-radius: 50%; background: #0071BF;
    border: 3px solid #0071BF; cursor: pointer; box-shadow: 0 2px 6px rgba(0,0,0,0.3);
  }

  .slider-card {
    background: #f9f9f9; border-radius: 12px; padding: 25px; margin-bottom: 30px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1); display: flex; align-items: center; gap: 20px;
  }
  .slider-circle {
    width: 60px; height: 60px; border-radius: 50%;
    display: flex; justify-content: center; align-items: center;
    font-weight: 800; color: #fff; font-size: 1em;
    background: linear-gradient(to bottom, #888, #666);
    border: 3px solid #fff;
    flex-shrink: 0;
  }
  .slider-content { flex: 1; }
  .slider-content label { display: block; margin-bottom: 10px; font-weight: 700; }

  /* Capital Projects */
  .projects {
    display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 16px; margin: 20px 0;
  }
  .project-btn {
    background: linear-gradient(to bottom, #0071BF, #001F3D); color: #fff;
    border: 3px solid transparent; padding: 20px; width: 220px; height: 140px;
    border-radius: 12px; cursor: pointer; font-weight: 700; font-size: 1em;
    text-align: center; box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    transition: transform 0.2s ease, box-shadow 0.2s ease;
    display: flex; flex-direction: column; justify-content: center; align-items: center;
    line-height: 1.2;
  }
  .project-btn:hover { transform: scale(1.05); box-shadow: 0 6px 12px rgba(0,0,0,0.2); }
  .project-btn.critical { border-color: #FF9936; }
  .project-btn.disabled { background-color: #ccc; color: #666; cursor: not-allowed; }
  .project-name { font-size: 0.95em; font-weight: 800; margin-bottom: 4px; }
  .project-cost { font-size: 0.8em; margin-bottom: 6px; }
  .required-text { color: #FF9936; font-size: 0.8em; margin-top: 4px; }

  /* Buttons */
  .button {
    background: linear-gradient(to bottom, #FF9936, #FF4713); color: white;
    border: none; padding: 14px 28px; border-radius: 8px; cursor: pointer;
    font-weight: bold; font-size: 1.1em; margin-top: 10px;
  }
  .button:hover { transform: scale(1.05); }
  .reserve-section .button,
  #reserveBtn {
    background: linear-gradient(to bottom, #64b5f6, #0071BF); /* Blue gradient for reserve buttons */
  }
  .reserve-section .button:hover,
  #reserveBtn:hover { transform: scale(1.05); }
  .warning { color: #b30000; font-weight: bold; margin-top: 10px; }
</style>
</head>
<body>
<header>Balance Your City</header>
<div class="section">
  <div class="progress-bar">
    <div class="year" id="year1">Year 1</div>
    <div class="year" id="year2">Year 2</div>
    <div class="year" id="year3">Year 3</div>
    <div class="year" id="year4">Year 4</div>
  </div>

  <!-- Tax Slider Card -->
  <div class="slider-card">
    <div class="slider-circle" id="taxCircle">3%</div>
    <div class="slider-content">
      <label><strong>Tax Increase</strong></label>
      <input type="range" id="taxRate" min="0" max="25" value="3">
    </div>
  </div>

  <h3>Select Capital Projects</h3>
  <div class="projects" id="projectButtons"></div>

  <h3>Adjust Department Budgets</h3>
  <div id="departmentSliders"></div>

  <div style="display:flex;align-items:center;gap:10px;">
    <strong id="statusDisplay" class="status">Shortfall: $0</strong>
    <button class="button" id="reserveBtn" style="display:none;">Add Surplus to Reserve</button>
  </div>

  <div class="reserve-section">
    <button class="button" disabled>Reserve Fund: $<span id="reserveDisplay">0</span></button>
    <button class="button" id="useReserveBtn">Use Reserve Fund</button>
  </div>

  <div id="criticalWarning" class="warning"></div>
  <button class="button" id="resetBtn">Reset Year</button>
  <button class="button" id="nextYearBtn" style="display:none;">Next Year</button>
</div>

<script>
const taxRateInput=document.getElementById('taxRate'),taxCircle=document.getElementById('taxCircle'),projectButtonsContainer=document.getElementById('projectButtons'),departmentSlidersContainer=document.getElementById('departmentSliders'),statusDisplay=document.getElementById('statusDisplay'),reserveDisplay=document.getElementById('reserveDisplay'),reserveBtn=document.getElementById('reserveBtn'),useReserveBtn=document.getElementById('useReserveBtn'),nextYearBtn=document.getElementById('nextYearBtn'),criticalWarning=document.getElementById('criticalWarning');let currentYear=1,selectedProjects=[],completedProjects=[],reserve=0,surplus=0,shortfall=0;const operatingCost=31500000,projects=[{name:"Recreation Center",cost:2000000},{name:"Road Expansion",cost:3500000},{name:"Water Treatment Upgrade",cost:4000000,deadline:4,critical:true},{name:"Library Renovation",cost:1500000},{name:"Fire Station Upgrade",cost:2500000},{name:"Community Pool",cost:1800000},{name:"Sports Complex",cost:3000000},{name:"Transit Hub",cost:2200000},{name:"Bike Path Network",cost:1200000},{name:"City Hall Renovation",cost:3500000},{name:"New Fire Truck",cost:800000,deadline:2,critical:true}],departments=["Fire & Police","Water & Utilities","Roads & Snow Clearing","Parks & Recreation","Waste & Recycling","Libraries & Community Services","Planning & Development"];function formatCurrency(e){return`$${Number(e).toLocaleString()}`}function updateProgressBar(){document.querySelectorAll(".year").forEach((e,t)=>{e.style.background=t+1===currentYear?"linear-gradient(to bottom,#FF9936,#FF4713)":t+1<currentYear?"linear-gradient(to bottom,#FF9936,#FF4713)":"#ddd",e.style.color=t+1===currentYear||t+1<currentYear?"#fff":"#000"})}function updateTaxSliderColor(){const e=parseInt(taxRateInput.value);let color=e<=3?"#fff":e>=25?"#000":e>=4?`rgb(${255-(e-4)*8},0,0)`:"#fff";taxRateInput.style.setProperty("--track-color",color);taxCircle.textContent=`${e}%`}function createProjectButtons(){projectButtonsContainer.innerHTML="",projects.forEach((e,t)=>{const n=document.createElement("button");n.className="project-btn";let content=`<div class="project-name">${e.name}</div><div class="project-cost">${formatCurrency(e.cost)}</div>`;if(e.critical){content+=`<div class="required-text">Required by Year ${e.deadline}</div>`;n.classList.add("critical");n.title=`Critical: Must be completed by Year ${e.deadline}`}n.innerHTML=content,completedProjects.includes(t)?(n.classList.add("disabled"),n.textContent=`${e.name}\n(Completed)`,n.disabled=!0):n.onclick=()=>{n.classList.contains("selected")?(n.classList.remove("selected"),selectedProjects=selectedProjects.filter(e=>e!==t)):(n.classList.add("selected"),selectedProjects.push(t)),updateStatus()},projectButtonsContainer.appendChild(n)})}function createDepartmentSliders(){departmentSlidersContainer.innerHTML="",departments.forEach(e=>{const t=e.replace(/\s|&/g,""),n=document.createElement("div");n.className="slider-card",n.innerHTML=`<div class="slider-circle" id="circle-${t}">100%</div><div class="slider-content"><label><strong>${e}</strong></label><input type="range" min="50" max="150" value="100" step="10" id="${t}"><div id="impact-${t}" style="font-size:0.9em;color:#555;">No change to service levels.</div></div>`,departmentSlidersContainer.appendChild(n),document.getElementById(t).addEventListener("input",()=>{const n=parseInt(document.getElementById(t).value);document.getElementById(`circle-${t}`).textContent=`${n}%`;const a=document.getElementById(`impact-${t}`),r=document.getElementById(t);let color=n<100?"linear-gradient(to bottom,#b30000,#800000)":n>100?"linear-gradient(to bottom,#28a745,#1b5e20)":"linear-gradient(to bottom,#888,#666)";document.getElementById(`circle-${t}`).style.background=color;r.style.setProperty("--track-color",n<100?"#b30000":n>100?"#28a745":"#ccc"),a.textContent=n<100?"Reduced service quality.":n>100?"Improved service quality.":"No change to service levels.",updateStatus()})})}function updateStatus(){updateTaxSliderColor();const e=parseFloat(taxRateInput.value);const t=3e7+500000*e;let n=selectedProjects.reduce((e,t)=>e+projects[t].cost,0);shortfall=operatingCost+n-t;let a=0;departments.forEach(e=>{const t=parseInt(document.getElementById(e.replace(/\s|&/g,"")).value);t<100?a-=2e5*((100-t)/10):t>100&&(a+=2e5*((t-100)/10))}),shortfall+=a,surplus=shortfall<0?Math.abs(shortfall):0,shortfall=shortfall<0?0:shortfall,statusDisplay.textContent=shortfall>0?`Shortfall: ${formatCurrency(shortfall)}`:`Surplus: ${formatCurrency(surplus)}`,statusDisplay.style.background=shortfall>0?"linear-gradient(to bottom,#b30000,#800000)":"linear-gradient(to bottom,#28a745,#1b5e20)",reserveDisplay.textContent=reserve.toLocaleString(),reserveBtn.style.display=surplus>0?"inline-block":"none",nextYearBtn.style.display=0===shortfall?"inline-block":"none"}reserveBtn.addEventListener("click",()=>{reserve+=surplus,surplus=0,statusDisplay.textContent="Surplus: $0",reserveDisplay.textContent=reserve.toLocaleString(),reserveBtn.style.display="none"}),useReserveBtn.addEventListener("click",()=>{if(reserve>0)if(shortfall>0)reserve>=shortfall?(reserve-=shortfall,surplus=reserve,shortfall=0):(shortfall-=reserve,reserve=0);else surplus+=reserve,reserve=0,statusDisplay.textContent=shortfall>0?`Shortfall: ${formatCurrency(shortfall)}`:`Surplus: ${formatCurrency(surplus)}`,statusDisplay.style.background=shortfall>0?"linear-gradient(to bottom,#b30000,#800000)":"linear-gradient(to bottom,#28a745,#1b5e20)",reserveDisplay.textContent=reserve.toLocaleString()}),nextYearBtn.addEventListener("click",()=>{const e=projects.findIndex(e=>"New Fire Truck"===e.name),t=projects.findIndex(e=>"Water Treatment Upgrade"===e.name);if(2===currentYear&&!completedProjects.includes(e)&&!selectedProjects.includes(e))return void(criticalWarning.textContent="⚠️ You cannot proceed! New Fire Truck must be completed by Year 2.");if(3===currentYear&&!completedProjects.includes(t)&&!selectedProjects.includes(t))return void(criticalWarning.textContent="⚠️ You cannot proceed! Water Treatment Upgrade must be completed by Year 4.");completedProjects.push(...selectedProjects),selectedProjects=[],currentYear++,taxRateInput.value=3,currentYear>4?(criticalWarning.textContent="✅ Term complete!",nextYearBtn.style.display="none"):(updateProgressBar(),createProjectButtons(),updateStatus())}),resetBtn.addEventListener("click",()=>{taxRateInput.value=3,selectedProjects=[],completedProjects=[],currentYear=1,updateProgressBar(),createProjectButtons(),createDepartmentSliders(),updateStatus()}),taxRateInput.addEventListener("input",updateStatus),createProjectButtons(),createDepartmentSliders(),updateProgressBar(),updateStatus();
</script>
</body>
</html>